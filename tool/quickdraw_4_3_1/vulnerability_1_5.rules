# (C) Copyright 2012, Digital Bond, Inc.
#
# Some rules are donated by ET Pro, NitroSecurity and Rockwell Automation as noted in the comments
#
# All rights reserved.
#
# Version 1.3 28 March 2011
#
#	Version 1.0	Initial Release
#	Version 1.1	06/02/2010
#			Added comments to the file
#			Modified source IP from any to any
#	Version 1.2	02/27/2011
#			Modified reference to new digitalbond.com web site
#			Added rules 1111604 to 1111616
#	Version 1.3	28 Mar 2011
#			Added Digital Bond vuln rules 1111617 to 1111619 
#			Added ET PRO vuln rules 1111620 to 1111680
#	Version 1.4	3 Oct 2011
#			Added Rockwell Automation Rules
#	Version 1.5	22 Mar 2012
#			Added Rockwell Automation Rules related to Project Basecamp vulnerabilities
#
#-----------------------------
#
# This vulnerability_exploit rules files contains IDS rules that detect exploit attempts on known
# control system vulnerabilities. It is not a comprehensive list. The CVE, if available, and common name of the 
# applicable vulnerability precedes each rule.
#
#
#-----------------------------
#
# CVE 2008-2639: CitectSCADA ODBC Overflow Attempt
#
alert tcp any any -> any 20222 (msg:"CitectSCADA ODBC Overflow Attempt"; flow:established,to_server; byte_test:4,>,399,0; dsize:4; reference:cve, CVE-2008-2639; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111601; rev:2; priority:1;)
#
# CVE-2008-2005: WonderWare SuiteLink DOS Attempt
#
alert tcp any any -> any 5413 (msg:"WonderWare SuiteLink DOS Attempt"; flow:established,to_server; byte_test:4,>,2742,56,little; reference:cve, CVE-2008-2005; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111602; rev:2; priority:1;)
#
# CVE-2008-4322: RealWin INFOTAG/SET_CONTROL Packet Processing Buffer Overflow
#
alert tcp any any -> any 910 (msg:"RealWin INFOTAG/SET_CONTROL Packet Processing Buffer Overflow"; content:"|10 23 54 67|"; depth:4; byte_test:4,>,739,0,little,relative; flow:established,to_server; reference:cve, CVE-2008-4322; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111603; rev:2; priority:1;)
#
# ICS A-10-314-01A: ClearSCADA Heap Overflow Attempt
#
alert tcp any any -> any 5481 (msg:"ClearSCADA Heap Overflow Attempt"; flow:established,to_server; dsize:>500; content: "|a7 0d 44 06 10 00 00 00 08 00 00 00|"; depth: 12; isdataat: 1000; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111604; rev:1; priority:1;)
#
# ICS A-10-314-01A: ClearSCADA Cross-site Scripting Attempt
# sid:1111605  In Development
#
# ICS A-10-314-01A: ClearSCADA Insecure Web Authentication Attempt
# sid:1111606  In Development
#
# CVE 2010-4557: Wonderware InBatch Buffer Overflow Attempt
#
alert tcp any any -> any 9001 (msg:"Wonderware InBatch Buffer Overflow Attempt"; flow:established,to_server; content:"|00 00 4b 14 00 00 00 00 00 00 00 01 00 00 00 00 00 01 00 00|"; depth:20; isdataat: 151; reference:cve, CVE-2010-4557; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111607; rev:1; priority:1;)
#
# CVE 2011-0517: Sielco Sistemi WinLog Stack Overflow Attempt
#
alert tcp any any -> any 46823 (msg:"Sielco Sistemi WinLog Stack Overflow Attempt"; flow:established,to_server; content:"|02 01 01|"; depth:3; isdataat: 61;  reference:cve, CVE-2011-0517; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111608; rev:1; priority:1;)
#
# CVE 2010-4598: Ecava IntegraXor Directory Traversal Attempt
#
alert tcp any any -> any 7131 (msg:"Ecava IntegraXor Directory Traversal Attempt"; flow:established,to_server; uricontent: "open?filename"; reference:cve, CVE-2010-4598; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111609; rev:1; priority:2;)
#
# CVE-2010-4142: RealWin HMI Service Buffer Overflow 1
#
alert tcp any any -> any 912 (msg:"RealWin HMI Service Buffer Overflow Attempt 1"; flow:established,to_server; content:"|64 12 54 6a 02 00 00 00|"; depth:8; byte_test:4,>,739,0,little,relative; reference:cve, CVE-2010-4142; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111610; rev:1; priority:1;)
#
# CVE-2010-4142: RealWin HMI Service Buffer Overflow 2
#
alert tcp any any -> any 912 (msg:"RealWin HMI Service Buffer Overflow Attempt 2"; flow:established,to_server; content:"|64 12 54 6a 20 00 00 00|"; depth:8; byte_test:4,>,739,0,little,relative; reference:cve, CVE-2010-4142; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111611; rev:1; priority:1;)
#
# CVE-2010-4142: RealWin HMI Service Buffer Overflow 3
#
alert tcp any any -> any 912 (msg:"RealWin HMI Service Buffer Overflow Attempt 3"; flow:established,to_server; content:"|64 12 54 6a 10 00 00 00|"; depth:8; byte_test:4,>,739,0,little,relative; reference:cve, CVE-2010-4142; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111612; rev:1; priority:1;
#
# CVE 2009-4462: Intellicom NetBiter Config HICP Hostname Buffer Overflow
#
alert udp any any -> any 3250 (msg:"NetBiter Config HICP Hostname Buffer Overflow"; content:"hn|20 3d|"; content:!"|3b|"; within: 19; reference:cve, CVE-2009-4462; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111613; rev:1; priority:1;)
#
# CVE 2011-0406: WellinTech KingView Remote Heap Overflow Attempt
# 
alert tcp any any -> any 777 (msg:"WellinTech KingView Remote Heap Overflow Attempt"; flow:established,to_server; stream_size: client,>,32800; content:"|eb 14|"; content: "|ad bb c3 77 b4 73 ed 77|"; within: 15; reference:cve, CVE-2011-0406; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111614; rev:1; priority:1;)
#
# CVE 20xx-xxx: IntelliCom NetBiter NB100 and NB200 - Directory Traversal Attempt
# 
alert tcp any any -> any any (msg:"NetBiter NB100 and NB200 Directory Traversal Attempt"; flow:established,to_server; uricontent: "/cgi-bin/read.cgi"; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111615; rev:1; priority:2;)
#
# CVE 20xx-xxx: VxWorks Information Disclosure Attempt
# 
alert udp any any -> any 17185 (msg:"VxWorks Debug Service Information Disclosure Attempt"; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111616; rev:1; priority:2;)
#
# CVE 2010-4709: Automated Solutions Modbus/TCP Master OPC server Modbus TCP Header Corruption Attempt
#
alert tcp any any -> any 502 (msg:"Automated Solutions: Modbus/TCP Master OPC server Modbus TCP Header Corruption Attempt"; byte_test: 2,>,500,4; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111617; rev:1; priority:1;)
#
# CVE 20xx-xxx: BroadWin/AdvancTech RPC Information Disclosure Vulnerability
#
alert tcp any any -> any 4592 (msg:"BroadWin/AdvancTech RPC Information Disclosure Vulnerability"; flow:to_server,established; dce_iface: 5d2b62aa-ee0a-4a95-91ae-b064fdb471fc; dce_opnum: 0-3; dce_stub_data; byte_jump:4,-4,relative,align,dce; byte_test:2,=,50003,4,relative,dce; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111618; rev:1; priority:1;)
#
# CVE 20xx-xxx: BroadWin/AdvancTech RPC/RCE Vulnerability 
#
alert tcp any any -> any 4592 (msg:"BroadWin/AdvancTech RPC/RCE Vulnerability"; flow:to_server,established; dce_iface: 5d2b62aa-ee0a-4a95-91ae-b064fdb471fc; dce_opnum: 0-3; dce_stub_data;byte_jump:4,-4,relative,align,dce; byte_test:2,=,10000,4,relative,dce; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111619; rev:1; priority:1;)
#
# ----------------------
#
# Rules 1111620 to 1111680 were donated by Emerging Threats Pro with assistance from Nitro Security
#
# They are distributed under the ET-PRO license that is included in the download zip and is available at
# http://rules.emergingthreats.net/open/snort-2.4.0/ETPRO-License.txt 
#
# ----------------------
#
# CVE 20xx-xxx: IGSS SCADA System Directory Traversal and Download
#
alert tcp any any -> any 12401 (msg:"ETPRO SCADA IGSS SCADA System Directory Traversal and Download"; flow:to_server,established; content:"|01 00 34 12 0D|"; offset:2; depth:5; content:"|03|"; distance:11; within:1; content:"|2E 2E 5C 2E 2E 5C 2E 2E 5C 2E 2E 5C|"; distance:0; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111620; rev:1;)
#
# CVE 20xx-xxx: IGSS SCADA system Directory Traversal Upload and Overwrite
#
alert tcp any any -> any 12401 (msg:"ETPRO SCADA IGSS SCADA system Directory Traversal Upload and Overwrite"; flow:to_server,established; content:"|01 00 34 12 0D|"; offset:2; depth:5; content:"|02|"; distance:11; within:1; content:"|2E 2E 5C 2E 2E 5C 2E 2E 5C 2E 2E 5C|"; distance:0; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111621; rev:1;)
#
# CVE 20xx-xxx: IGSS SCADA ListAll Function Buffer Overflow
#
alert tcp any any -> any 12401 (msg:"ETPRO SCADA IGSS SCADA ListAll Function Buffer Overflow"; flow:to_server,established; byte_test:2,>,278,0,little; content:"|01 00 34 12 0D|"; offset:2; depth:5; content:"|01|"; distance:11; within:1; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111622; rev:1;)
#
# CVE 20xx-xxx: IGSS SCADA Write File Function Buffer Overflow
#
alert tcp any any -> any 12401 (msg:"ETPRO SCADA IGSS SCADA Write File Function Buffer Overflow"; flow:to_server,established; byte_test:2,>,278,0,little; content:"|01 00 34 12 0D|"; offset:2; depth:5; content:"|02|"; distance:11; within:1; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111623; rev:1;)
#
# CVE 20xx-xxx: IGSS SCADA ReadFile Function Buffer Overflow
#
alert tcp any any -> any 12401 (msg:"ETPRO SCADA IGSS SCADA ReadFile Function Buffer Overflow"; flow:to_server,established; byte_test:2,>,278,0,little; content:"|01 00 34 12 0D|"; offset:2; depth:5; content:"|03|"; distance:11; within:1; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111624; rev:1;)
#
# CVE 20xx-xxx: IGSS SCADA Delete Function Buffer Overflow
#
alert tcp any any -> any 12401 (msg:"ETPRO SCADA IGSS SCADA Delete Function Buffer Overflow"; flow:to_server,established; byte_test:2,>,278,0,little; content:"|01 00 34 12 0D|"; offset:2; depth:5; content:"|04|"; distance:11; within:1; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111625; rev:1;)
#
# CVE 20xx-xxx: IGSS SCADA RenameFile Function Buffer Overflow
#
alert tcp any any -> any 12401 (msg:"ETPRO SCADA IGSS SCADA RenameFile Function Buffer Overflow"; flow:to_server,established; byte_test:2,>,278,0,little; content:"|01 00 34 12 0D|"; offset:2; depth:5; content:"|05|"; distance:11; within:1; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111626; rev:1;)
#
# CVE 20xx-xxx: IGSS SCADA FileInfo Function Buffer Overflow
#
alert tcp any any -> any 12401 (msg:"ETPRO SCADA IGSS SCADA FileInfo Function Buffer Overflow"; flow:to_server,established; byte_test:2,>,278,0,little; content:"|01 00 34 12 0D|"; offset:2; depth:5; content:"|06|"; distance:11; within:1; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111627; rev:1;)
#
# CVE 20xx-xxx: IGSS SCADA RMS Report Add Command Buffer Overflow
#
alert tcp any any -> any 12401 (msg:"ETPRO SCADA IGSS SCADA RMS Report Add Command Buffer Overflow"; flow:to_server,established; byte_test:2,>,278,0,little; content:"|01 00 34 12 07|"; offset:2; depth:5; content:"|04|"; distance:11; within:1; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111628; rev:1;)
#
# CVE 20xx-xxx: IGSS SCADA RMS Report Template ReadFile Command Buffer Overflow
#
alert tcp any any -> any 12401 (msg:"ETPRO SCADA IGSS SCADA RMS Report Template ReadFile Command Buffer Overflow"; flow:to_server,established; byte_test:2,>,278,0,little; content:"|01 00 34 12 07|"; offset:2; depth:5; content:"|06|"; distance:11; within:1; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111629; rev:1;)
#
# CVE 20xx-xxx: IGSS SCADA RMS Report Template WriteFile Command Buffer Overflow
#
alert tcp any any -> any 12401 (msg:"ETPRO SCADA IGSS SCADA RMS Report Template WriteFile Command Buffer Overflow"; flow:to_server,established; byte_test:2,>,278,0,little; content:"|01 00 34 12 07|"; offset:2; depth:5; content:"|05|"; distance:11; within:1; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111630; rev:1;)
#
# CVE 20xx-xxx: IGSS SCADA RMS Report Template Add Command Buffer Overflow
#
alert tcp any any -> any 12401 (msg:"ETPRO SCADA IGSS SCADA RMS Report Template Add Command Buffer Overflow"; flow:to_server,established; byte_test:2,>,534,0,little; content:"|01 00 34 12 07|"; offset:2; depth:5; content:"|04|"; distance:11; within:1; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111631; rev:1;)
#
# CVE 20xx-xxx: IGSS SCADA RMS Report Template Rename Command Buffer Overflow
#
alert tcp any any -> any 12401 (msg:"ETPRO SCADA IGSS SCADA RMS Report Template Rename Command Buffer Overflow"; flow:to_server,established; byte_test:2,>,534,0,little; content:"|01 00 34 12 07|"; offset:2; depth:5; content:"|02|"; distance:11; within:1; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111632; rev:1;)
#
# CVE 20xx-xxx: IGSS SCADA RMS Report Template Delete Command Buffer Overflow
#
alert tcp any any -> any 12401 (msg:"ETPRO SCADA IGSS SCADA RMS Report Template Delete Command Buffer Overflow"; flow:to_server,established; byte_test:2,>,534,0,little; content:"|01 00 34 12 07|"; offset:2; depth:5; content:"|03|"; distance:11; within:1; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111633; rev:1;)
#
# CVE 20xx-xxx: IGSS SCADA STDREP Request Buffer Overflow
#
alert tcp any any -> any 12401 (msg:"ETPRO SCADA IGSS SCADA STDREP Request Buffer Overflow"; flow:to_server,established; byte_test:2,>,278,0,little; content:"|01 00 34 12 08|"; offset:2; depth:5; content:"|04|"; distance:11; within:1; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111634; rev:1;)
#
# CVE 20xx-xxx: IGSS SCADA dc.exe Server Directory Traversal Arbitrary File Execution - 0xa
#
alert tcp any any -> any 12397 (msg:"ETPRO SCADA IGSS SCADA dc.exe Server Directory Traversal Arbitrary File Execution - 0xa"; flow:to_server,established; content:"|0a|"; offset:12; depth:1; content:"|2E 2E 5C 2E 2E 5C 2E 2E 5C 2E 2E 5C 2E 2E 5C|"; distance:0; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111635; rev:1;)
#
# CVE 20xx-xxx: IGSS SCADA dc.exe Server Directory Traversal Arbitrary File Execution - 0x17
#
alert tcp any any -> any 12397 (msg:"ETPRO SCADA IGSS SCADA dc.exe Server Directory Traversal Arbitrary File Execution - 0x17"; flow:to_server,established; content:"|17|"; offset:12; depth:1; content:"|2E 2E 5C 2E 2E 5C 2E 2E 5C 2E 2E 5C 2E 2E 5C|"; distance:0; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111636; rev:1;)
#
# CVE 20xx-xxx: RealFlex RealWin SCADA SCPC_TXTEVENT strcpy() Buffer Overflow
#
alert tcp any any -> any 912 (msg:"ETPRO SCADA RealFlex RealWin SCADA SCPC_TXTEVENT strcpy() Buffer Overflow"; flow:to_server,established; isdataat:215; content:"|64 12 54 6a 10 00 00 00|"; offset:0; byte_test:4,>,200,0,relative,little; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111637; rev:1;)
#
# CVE 20xx-xxx: RealFlex RealWin SCADA On_FC_CONNECT_FCS_LOGIN Buffer Overflow
#
alert tcp any any -> any 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_CONNECT_FCS_LOGIN Buffer Overflow"; flow:to_server,established; isdataat:768; content:"|10 23 54 67|"; offset:0; byte_test:4,>,768,0,relative,little; content:"|01 00 01 00|"; distance:6; within:4; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111638; rev:1;)
#
# CVE 20xx-xxx: RealFlex RealWin SCADA On_FC_CTAGLIST_FCS_CADDTAG Buffer Overflow
#
alert tcp any any -> any 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_CTAGLIST_FCS_CADDTAG Buffer Overflow"; flow:to_server,established; isdataat:768; content:"|10 23 54 67|"; offset:0; byte_test:4,>,768,0,relative,little; content:"|05 00 01 00|"; distance:6; within:4; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111639; rev:1;)
#
# CVE 20xx-xxx: RealFlex RealWin SCADA On_FC_CTAGLIST_FCS_CDELTAG Buffer Overflow
#
alert tcp any any -> any 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_CTAGLIST_FCS_CDELTAG Buffer Overflow"; flow:to_server,established; isdataat:768; content:"|10 23 54 67|"; offset:0; byte_test:4,>,768,0,relative,little; content:"|05 00 02 00|"; distance:6; within:4; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111640; rev:1;)
#
# CVE 20xx-xxx: RealFlex RealWin SCADA On_FC_CTAGLIST_FCS_ADDTAGMS Buffer Overflow
#
alert tcp any any -> any 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_CTAGLIST_FCS_ADDTAGMS Buffer Overflow"; flow:to_server,established; isdataat:768; content:"|10 23 54 67|"; offset:0; byte_test:4,>,768,0,relative,little; content:"|05 00 05 00|"; distance:6; within:4; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111641; rev:1;)
#
# CVE 20xx-xxx: RealFlex RealWin SCADA On_FC_RFUSER_FCS_LOGIN Buffer Overflow
#
alert tcp any any -> any 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_RFUSER_FCS_LOGIN Buffer Overflow"; flow:to_server,established; isdataat:59; content:"|10 23 54 67|"; offset:0; byte_test:4,>,44,0,relative,little; content:"|11 00 01 00|"; distance:6; within:4; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111642; rev:1;)
#
# CVE 20xx-xxx: RealFlex RealWin SCADA On_FC_BINFILE_FCS_*FILE Buffer Overflow 1
#
alert tcp any any -> any 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_BINFILE_FCS_*FILE Buffer Overflow 1"; flow:to_server,established; isdataat:270; content:"|10 23 54 67|"; offset:0; byte_test:4,>,256,0,relative,little; content:"|10 00 01 00|"; distance:6; within:4; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111643; rev:1;)
#
# CVE 20xx-xxx: RealFlex RealWin SCADA On_FC_BINFILE_FCS_*FILE Buffer Overflow 2
#
alert tcp any any -> any 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_BINFILE_FCS_*FILE Buffer Overflow 2"; flow:to_server; isdataat:270; content:"|10 23 54 67|"; offset:0; byte_test:4,>,256,0,relative,little; content:"|10 00 03 00|"; distance:6; within:4; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111644; rev:1;)
#
# CVE 20xx-xxx: RealFlex RealWin SCADA On_FC_BINFILE_FCS_*FILE Buffer Overflow 3
#
alert tcp any any -> any 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_BINFILE_FCS_*FILE Buffer Overflow 3"; flow:to_server,established; isdataat:270; content:"|10 23 54 67|"; offset:0; byte_test:4,>,256,0,relative,little; content:"|10 00 08 00|"; distance:6; within:4; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111645; rev:1;)
#
# CVE 20xx-xxx: RealFlex RealWin SCADA On_FC_BINFILE_FCS_*FILE Buffer Overflow 4
#
alert tcp any any -> any 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_BINFILE_FCS_*FILE Buffer Overflow 4"; flow:to_server,established; isdataat:270; content:"|10 23 54 67|"; offset:0; byte_test:4,>,256,0,relative,little; content:"|10 00 0A 00|"; distance:6; within:4; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111646; rev:1;)
#
# CVE 20xx-xxx: RealFlex RealWin SCADA On_FC_BINFILE_FCS_*FILE Buffer Overflow 5
#
alert tcp any any -> any 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_BINFILE_FCS_*FILE Buffer Overflow 5"; flow:to_server,established; isdataat:270; content:"|10 23 54 67|"; offset:0; byte_test:4,>,256,0,relative,little; content:"|10 00 0B 00|"; distance:6; within:4; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111647; rev:1;)
#
# CVE 20xx-xxx: RealFlex RealWin SCADA On_FC_BINFILE_FCS_*FILE Buffer Overflow 6
#
alert tcp any any -> any 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_BINFILE_FCS_*FILE Buffer Overflow 6"; flow:to_server,established; isdataat:270; content:"|10 23 54 67|"; offset:0; byte_test:4,>,256,0,relative,little; content:"|10 00 0D 00|"; distance:6; within:4; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111648; rev:1;)
#
# CVE 20xx-xxx: RealFlex RealWin SCADA On_FC_MISC_FCS_MSGBROADCAST Buffer Overflow
#
alert tcp any any -> any 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_MISC_FCS_MSGBROADCAST Buffer Overflow"; flow:to_server,established; isdataat:768; content:"|10 23 54 67|"; offset:0; byte_test:4,>,768,0,relative,little; content:"|0F 00 01 00|"; distance:6; within:4; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111649; rev:1;)
#
# CVE 20xx-xxx: RealFlex RealWin SCADA On_FC_MISC_FCS_MSGSEND Buffer Overflow
#
alert tcp any any -> any 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_MISC_FCS_MSGSEND Buffer Overflow"; flow:to_server,established; isdataat:768; content:"|10 23 54 67|"; offset:0; byte_test:4,>,768,0,relative,little; content:"|0F 00 03 00|"; distance:6; within:4; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111650; rev:1;)
#
# CVE 20xx-xxx: RealFlex RealWin SCADA On_FC_CGETTAG_FCS_GETTELEMETRY Buffer Overflow
#
alert tcp any any -> any 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_CGETTAG_FCS_GETTELEMETRY Buffer Overflow"; flow:to_server,established; isdataat:215; content:"|10 23 54 67|"; offset:0; byte_test:4,>,200,0,relative,little; content:"|02 00 0F 00|"; distance:6; within:4; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111651; rev:1;)
#
# CVE 20xx-xxx: RealFlex RealWin SCADA On_FC_CGETTAG_FCS_GETCHANNELTELEMETRY Buffer Overflow
#
alert tcp any any -> any 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_CGETTAG_FCS_GETCHANNELTELEMETRY Buffer Overflow"; flow:to_server,established; isdataat:215; content:"|10 23 54 67|"; offset:0; byte_test:4,>,200,0,relative,little; content:"|02 00 10 00|"; distance:6; within:4; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111652; rev:1;)
#
# CVE 20xx-xxx: RealFlex RealWin SCADA On_FC_CGETTAG_FCS_SETTELEMETRY Buffer Overflow
#
alert tcp any any -> any 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_CGETTAG_FCS_SETTELEMETRY Buffer Overflow"; flow:to_server,established; isdataat:215; content:"|10 23 54 67|"; offset:0; byte_test:4,>,200,0,relative,little; content:"|04 00 12 00|"; distance:6; within:4; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111653; rev:1;)
#
# CVE 20xx-xxx: RealFlex RealWin SCADA On_FC_CGETTAG_FCS_SETCHANNELTELEMETRY Buffer Overflow
#
alert tcp any any -> any 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_CGETTAG_FCS_SETCHANNELTELEMETRY Buffer Overflow"; flow:to_server,established; isdataat:215; content:"|10 23 54 67|"; offset:0; byte_test:4,>,200,0,relative,little; content:"|04 00 13 00|"; distance:6; within:4; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111654; rev:1;)
#
# CVE 20xx-xxx: RealFlex RealWin SCADA On_FC_SCRIPT_FCS_STARTPROG Buffer Overflow
#
alert tcp any any -> any 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_SCRIPT_FCS_STARTPROG Buffer Overflow"; flow:to_server,established; isdataat:1000; content:"|10 23 54 67|"; offset:0; byte_test:4,>,1000,0,relative,little; content:"|09 00 12 00|"; distance:6; within:4; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111655; rev:1;)
#
# CVE 20xx-xxx: Iconics Genesis SCADA Freeing of Unitialized Memory Trigger Option 1
# 
alert tcp any any -> any 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Freeing of Unitialized Memory Trigger Option 1"; flow:to_server,established; dsize:62;content:"|b0 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff 0f 00 00 ff 0f 00 00|"; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111656; rev:1;)
#
# CVE 20xx-xxx: Iconics Genesis SCADA Freeing of Unitialized Memory Trigger Option 2
# 
alert tcp any any -> any 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Freeing of Unitialized Memory Trigger Option 2"; flow:to_server,established; dsize:28;content:"|B2 04 00 00 FF 0F 00 00|"; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111657; rev:1;)
#
# CVE 20xx-xxx: Iconics Genesis SCADA Freeing of Unitialized Memory Trigger Option 3
#
alert tcp any any -> any 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Freeing of Unitialized Memory Trigger Option 3"; flow:to_server,established;dsize:38;content:"|b5 04 00 00 00 00 00 00 00 00 00 00 00 00 ff 0f 00 00|"; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111658; rev:1;)
#
# CVE 20xx-xxx: Iconics Genesis SCADA Freeing of Unitialized Memory Trigger Option 4
#
alert tcp any any -> any 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Freeing of Unitialized Memory Trigger Option 4"; flow:to_server,established; dsize:28;content:"|AE 0D 00 00 FF 0F 00 00|"; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111659; rev:1;)
#
# CVE 20xx-xxx: Iconics Genesis SCADA Freeing of Unitialized Memory Trigger Option 5
#
alert tcp any any -> any 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Freeing of Unitialized Memory Trigger Option 5"; flow:to_server,established; dsize:37;content:"|bc 1b 00 00 00 00 00 00 00 00 00 00 00 ff 0f 00 00|"; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111660; rev:1;)
#
# CVE 20xx-xxx: Iconics Genesis SCADA Integer Overflow 0x9a08
#
alert tcp any any -> any 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Integer Overflow 0x9a08"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|9A 08|"; distance:4; within:2; isdataat:1024; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111661; rev:1;)
#
# CVE 20xx-xxx: Iconics Genesis SCADA Integer Overflow 0x5304
#
alert tcp any any -> any 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Integer Overflow 0x5304"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|53 04|"; distance:4; within:2; isdataat:1024; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111662; rev:1;)
#
# CVE 20xx-xxx: Iconics Genesis SCADA Integer Overflow 0x04b0
#
alert tcp any any -> any 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Integer Overflow 0x04b0"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|B0 04|"; distance:4; within:2; isdataat:1024; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111663; rev:1;)
#
# CVE 20xx-xxx: Iconics Genesis SCADA Integer Overflow 0x04b2
#
alert tcp any any -> any 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Integer Overflow 0x04b2"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|B2 04|"; distance:4; within:2; isdataat:1024; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111664; rev:1;)
#
# CVE 20xx-xxx: Iconics Genesis SCADA Integer Overflow 0x04b5
#
alert tcp any any -> any 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Integer Overflow 0x04b5"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|B5 04|"; distance:4; within:2; isdataat:1024; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111665; rev:1;)
#
# CVE 20xx-xxx: Iconics Genesis SCADA Integer Overflow 0x7d0
#
alert tcp any any -> any 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Integer Overflow 0x7d0"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|d0 07|"; distance:4; within:2; isdataat:1024; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111666; rev:1;)
#
# CVE 20xx-xxx: Iconics Genesis SCADA Integer Overflow 0xdae
#
alert tcp any any -> any 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Integer Overflow 0xdae"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|ae 0d|"; distance:4; within:2; isdataat:1024; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111667; rev:1;)
#
# CVE 20xx-xxx: Iconics Genesis SCADA Integer Overflow 0xfa4
#
alert tcp any any -> any 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Integer Overflow 0xfa4"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|a4 0f|"; distance:4; within:2; isdataat:1024; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111668; rev:1;)
#
# CVE 20xx-xxx: Iconics Genesis SCADA Integer Overflow 0xfa7
#
alert tcp any any -> any 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Integer Overflow 0xfa7"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|a7 0f|"; distance:4; within:2; isdataat:1024; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111669; rev:1;)
#
# CVE 20xx-xxx: Iconics Genesis SCADA Integer Overflow 0x1bbc
#
alert tcp any any -> any 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Integer Overflow 0x1bbc"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|bc 1b|"; distance:4; within:2; isdataat:1024; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111670; rev:1;)
#
# CVE 20xx-xxx: Iconics Genesis SCADA Integer Overflow 0x1c84
#
alert tcp any any -> any 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Integer Overflow 0x1c84"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|84 1c|"; distance:4; within:2; isdataat:1024; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111671; rev:1;)
#
# CVE 20xx-xxx: Iconics Genesis SCADA Integer Overflow 0x26ac
#
alert tcp any any -> any 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Integer Overflow 0x26ac"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|ac 26|"; distance:4; within:2; isdataat:1024; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111672; rev:1;)
#
# CVE 20xx-xxx: Siemens Tecnomatix FactoryLink CSService CSMSG path Buffer Overflow
#
alert tcp any any -> any 7580 (msg:"ETPRO SCADA Siemens Tecnomatix FactoryLink CSService CSMSG path Buffer Overflow"; flow:to_server,established; content:"LEN|00|"; depth:4; byte_test:4,>,1028,0,little; content:"|99|"; distance:8; within:1; content:"|99  00 00 00 06  00 00 00 03  06|"; distance:0; byte_test:4,>,1024,0,big; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111673; rev:1;)
#
# CVE 20xx-xxx: Siemens Tecnomatix FactoryLink CSService CSMSG filter Buffer Overflow
#
alert tcp any any -> any 7580 (msg:"ETPRO SCADA Siemens Tecnomatix FactoryLink CSService CSMSG filter Buffer Overflow"; flow:to_server,established; content:"LEN|00|"; depth:4; byte_test:4,>,1024,0,little; content:"|99|"; distance:8; within:1; content:"|99  00 00 00 06  00 00 00 03  06|"; distance:0; byte_test:4,<,1029,0,big; byte_jump:4,0,big,relative; content:"|06|"; distance:0; within:1; byte_test:4,>,1024,0,big; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111674; rev:1;)
#
# CVE 20xx-xxx: Siemens Tecnomatix FactoryLink CSService GetFile path Buffer Overflow
#
alert tcp any any -> any 7580 (msg:"ETPRO SCADA Siemens Tecnomatix FactoryLink CSService GetFile path Buffer Overflow"; flow:to_server,established; content:"LEN|00|"; depth:4; byte_test:4,>,1028,0,little; content:"|99|"; distance:8; within:1; content:"|99  00 00 00 08  00 00 00 02  06|"; distance:0; byte_test:4,>,1024,0,big; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111675; rev:1;)
#
# CVE 20xx-xxx: Siemens Tecnomatix FactoryLink CSService GetFileInfo path Buffer Overflow
#
alert tcp any any -> any 7580 (msg:"ETPRO SCADA Siemens Tecnomatix FactoryLink CSService GetFileInfo path Buffer Overflow"; flow:to_server,established; content:"LEN|00|"; depth:4; byte_test:4,>,1028,0,little; content:"|99|"; distance:8; within:1; content:"|99  00 00 00 0a  00 00 00 01  06|"; distance:0; byte_test:4,>,1024,0,big; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111676; rev:1;)
#
# CVE 20xx-xxx: Siemens Tecnomatix FactoryLink CSService CSMSG path possible file download
#
alert tcp any any -> any 7580 (msg:"ETPRO SCADA Siemens Tecnomatix FactoryLink CSService CSMSG path possible file download"; flow:to_server,established; content:"LEN|00|"; depth:4; content:"|99|"; distance:8; within:1; content:"|99  00 00 00 06  00 00 00 03  06|"; pcre:"/^.{8}([A-Z]\x00?\x3a\x00?\x5c\x00?\x5c\x00?|\x2e\x00?\x2e\x00?\x5c\x00?)/Ri"; classtype:attempted-recon; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111677; rev:1;)
#
# CVE 20xx-xxx: Siemens Tecnomatix FactoryLink CSService CSMSG filter possible file download
#
alert tcp any any -> any 7580 (msg:"ETPRO SCADA Siemens Tecnomatix FactoryLink CSService CSMSG filter possible file download"; flow:to_server,established; content:"LEN|00|"; depth:4; content:"|99|"; distance:8; within:1; content:"|99  00 00 00 06  00 00 00 03  06|"; byte_test:4,<,1029,0,big; byte_jump:4,0,big,relative; content:"|06|"; distance:0; within:1; pcre:"/^.{8}([A-Z]\x00?\x3a\x00?\x5c\x00?\x5c\x00?|\x2e\x00?\x2e\x00?\x5c\x00?)/Ri"; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111678; rev:1;)
#
# CVE 20xx-xxx: Siemens Tecnomatix FactoryLink CSService GetFile possible file download
#
alert tcp any any -> any 7580 (msg:"ETPRO SCADA Siemens Tecnomatix FactoryLink CSService GetFile possible file download"; flow:to_server,established; content:"LEN|00|"; depth:4; content:"|99|"; distance:8; within:1; content:"|99  00 00 00 08  00 00 00 02  06|"; pcre:"/^.{8}([A-Z]\x00?\x3a\x00?\x5c\x00?\x5c\x00?|\x2e\x00?\x2e\x00?\x5c\x00?)/Ri"; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111679; rev:1;)
#
# CVE 20xx-xxx: Siemens Tecnomatix FactoryLink CSService GetFileInfo possible file download
#
alert tcp any any -> any 7580 (msg:"ETPRO SCADA Siemens Tecnomatix FactoryLink CSService GetFileInfo possible file download"; flow:to_server,established; content:"LEN|00|"; depth:4; content:"|99|"; distance:8; within:1; content:"|99  00 00 00 0a  00 00 00 01  06|"; pcre:"/^.{8}([A-Z]\x00?\x3a\x00?\x5c\x00?\x5c\x00?|\x2e\x00?\x2e\x00?\x5c\x00?)/Ri"; classtype:attempted-user; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; sid:1111680; rev:1;)
#
#
#
# # The following five rules were developed in response to ICSA-11-273-03 Rockwell RSLogix Denial of Service Vulnerability. They were developed by NitroSecurity in 
# partnership with Rockwell Automation and graciously donated to the Quickdraw SCADA IDS.
#
# Note 1: In addition to identifying the denial of service attack on the RSLogix and FactoryTalk vulnerability, these signatures will also identify out of spec
# behavior that could be used in other attacks.
#
# Note 2: You need to add the following variable, $ROCKWELL_PORTS to the conf file.
#
# $ROCKWELL_PORTS = [1330,1331,1332,4241,4242,4445,4446,5241,6543,9111,60093,49281]#
# 
# Check for Large Header Length#
alert tcp any any -> $HOME_NET $ROCKWELL_PORTS (msg:"Rockwell RNA Message Large Header Length - 8Kb"; flow:to_server; content:"rna|f2|"; byte_test:4,>,0x2000,0,relative,little; classtype:attempted-dos; sid:1111681; rev:1;)
# 
# Check for Negative Header Length
#
alert tcp any any -> $HOME_NET $ROCKWELL_PORTS (msg:"Rockwell RNA Message Negative Header Length"; flow:to_server; content:"rna|f2|"; byte_test:1,&,0x80,3,relative,little; classtype:attempted-dos; sid:1111682; rev:1;)
# 
# Check for Large Body Length#
alert tcp any any -> $HOME_NET $ROCKWELL_PORTS (msg:"Rockwell RNA Message Large Body Length - 8Mb"; flow:to_server; content:"rna|f2|"; byte_jump:4,0,relative,little; byte_test:4,>,0x800000,0,relative,little; classtype:attempted-dos; sid:1111683; rev:1;)
# 
# Check for Negative Body Length
#
alert tcp any any -> $HOME_NET $ROCKWELL_PORTS (msg:"Rockwell RNA Message Negative Body Length"; flow:to_server; content:"rna|f2|"; byte_jump:4,0,relative,little; byte_test:1,&,0x80,3,relative,little; classtype:attempted-dos; sid:1111684; rev:1;)
# 
# Ensure Null Terminated Header#
alert tcp any any -> $HOME_NET $ROCKWELL_PORTS (msg:"Rockwell RNA Message Header Not Null Terminated"; flow:to_server; content:"rna|f2|"; byte_jump:4,0,relative,little; content:!"|00|"; distance:-1; within:1; classtype:attempted-dos; sid:1111685; rev:1;)
#
#
#
# The following six rules were developed and donated to Quickdraw by Rockwell Automation in response to vulnerabilities identified in Project Basecamp.
#
#
# Attack: Forcing a CPU Stop
# Impact: Stops the CPU, leaving it in a ÔMajor recoverable faultÕ state. In order to clear the fault the key needs to be turned manually from RUN to PROG twice.
# // CIP - Unconnected send Ð CM via 0x52 
# // Service: 0x7 (STOP) 
# // Class: 0x64 unsigned char packetCPUStop[]=
# "\x00\x00\x00\x00\x02\x00\x02\x00\x00\x00\x00\x00\xb2\x00\x1a\x00"
# "\x52\x02\x20\x06\x24\x01\x03\xf0\x0c\x00\x07\x02\x20\x64\x24\x01"
# "\xDE\xAD\xBE\xEF\xCA\xFE\x01\x00\x01\x00";
# 
alert tcp any any -> $ENIP_SERVER 44818 (msg:"ROCKWELL Automation ControlLogix Denial of Service (CPU Stop)"; flow:to_server; content:"|6f 00|"; offset:0; depth:2; content:"|00 00 00 00|"; distance:22; within:4; byte_extract:2,2,count,relative,multiplier 4,little; content:"|b2 00|"; distance:0; within:count; content:"|52|"; distance:2; within:1; byte_jump:1,0,relative,multiplier 2; content:"|07|"; distance:4; within:1; classtype:attempted-dos; reference:osvdb,78489; reference:secunia,47737; sid:1111686; rev:1;)
#
# Attack: Crash CPU
# Impact: Crashes the CPU due to a malformed request, leaving it in a ÔMajor recoverable faultÕ state. In order to clear the fault the key needs to be turned manually from RUN to PROG twice.
# // CIP - Unconnected send Ð CM via 0x52 
# // Service: 0xa Multipel service packet 
# // Class: 0x2 Message Router unsigned char packetCrashCPU[]=
# "\x00\x00\x00\x00\x02\x00\x02\x00\x00\x00\x00\x00\xb2\x00\x1a\x00"
# "\x52\x02\x20\x06\x24\x01\x03\xf0\x0c\x00\x0a\x02\x20\x02\x24\x01"
# "\xf4\xf0\x09\x09\x88\x04\x01\x00\x01\x00";
# 
alert tcp any any -> $ENIP_SERVER 44818 (msg:"ROCKWELL Automation ControlLogix Denial of Service (Crash CPU)"; flow:to_server; content:"|6f 00|"; offset:0; depth:2; content:"|00 00 00 00|"; distance:22; within:4; byte_extract:2,2,count,relative,multiplier 4,little; content:"|b2 00|"; distance:0; within:count; content:"|52|"; distance:2; within:1; byte_jump:1,0,relative,multiplier 2; content:"|0a|"; distance:4; within:1; classtype:attempted-dos; reference:osvdb,78486; reference:secunia,47737; sid:1111687; rev:1;)
# 
# Attack: Dump 1756- ENBTÕs module boot code
# Impact: A ÔcuriousÕ undocumented service that allows remotely dumping of the EtherNET/IP moduleÕs boot code 
# // CIP - Unconnected send 
# // Service: 0x97 
# // Class: 0xc0 unsigned char packetDump[]=
# "\x00\x00\x00\x00\x00\x04\x02\x00\x00\x00\x00\x00\xb2\x00\x08\x00"
# "\x97\x02\x20\xc0\x24\x00\x00\x00";
# 
alert tcp any any -> $ENIP_SERVER 44818 (msg:"ROCKWELL Automation ControlLogix EtherNET/IP modules boot code dump (Dump)"; flow:to_server; content:"|6f 00|"; offset:0; depth:2; content:"|00 00 00 00|"; distance:22; within:4; byte_extract:2,2,count,relative,multiplier 4,little; content:"|b2 00|"; distance:0; within:count; content:"|97 02 20 c0 24|"; distance:2; within:5; classtype:data-attempt; reference:osvdb,78490; reference:secunia,47737; sid:1111688; rev:1;)
# 
# Attack: Reset 1756-ENBT module
# Impact: Resets the EtherNET/IP module.
# // CIP - Unconnected send
# // Service: 0x5 (RESET)
# // Class: 0x01 (Identity Manager) unsigned char packetResetEth[]=
# "\x00\x00\x00\x00\x00\x04\x02\x00\x00\x00\x00\x00\xb2\x00\x08\x00"
# "\x05\x03\x20\x01\x24\x01\x30\x03";
# 
alert tcp any any -> $ENIP_SERVER 44818 (msg:"ROCKWELL Automation ControlLogix EtherNET/IP reset command Denial Of Service (ResetEth)"; flow:to_server; content:"|6f 00|"; offset:0; depth:2; content:"|00 00 00 00|"; distance:22; within:4; byte_extract:2,2,count,relative,multiplier 4,little; content:"|b2 00|"; distance:0; within:count; content:"|05|"; distance:2; within:1; content:"|20 01|"; distance:1; within:2; classtype:attempted-dos; reference:osvdb,78491; reference:secunia,47737; sid:1111689; rev:1;)
#
# Attack: Crash 1756-ENBT module
# Impact: Crashes the module due to a vulnerability in the CIP stack 
# (ci_ParseSegment function) so other packets can also trigger this 
# flaw.
# // CIP - Unconnected send
# // Service: 0xe ( Get Attribute Single) 
# // Class: 0xF5 (TCP/IP) [Others can be possible] unsigned char packetCrashEth[]=
# "\x00\x00\x00\x00\x20\x00\x02\x00\x00\x00\x00\x00\xb2\x00\x0c\x00"
# "\x0e\x03\x20\xf5\x24\x01\x10\x43\x24\x01\x10\x43";
# 
alert tcp any any -> $ENIP_SERVER 44818 (msg:"ROCKWELL Automation ControlLogix Crash 1756-ENBT module (CrashEth)"; flow:to_server; content:"|6f 00|"; offset:0; depth:2; content:"|00 00 00 00|"; distance:22; within:4; byte_extract:2,2,count,relative,multiplier 4,little; content:"|b2 00|"; distance:0; within:count; content:"|0e|"; distance:2; within:1; content:"|20 f5|"; distance:1; within:2; classtype:attempted-admin; reference:osvdb,78487; reference:secunia,47737; sid:1111690; rev:1;)
#
# Attack: Flash Update
# Impact: Initialize the device to update the firmware.
# // CIP - Unconnected send
# // Service: 0x4b ( NV_UPDATE Ðvendor specific name extracted from firmware ) 
# // Class: 0xA1 (Non-Volatile Object Ð vendor specific name extracted from firmware) 
# // After issuing this service we would load our own firmware via the service code 0x4d (nv_transfer) unsigned char packetFlashUp[]= 
# "\x00\x00\x00\x00\x05\x00\x02\x00\x00\x00\x00\x00\xb2\x00\x16\x00"
# "\x4b\x02\x20\xa1\x24\x01\x05\x99\x07\x00\x4f\x02\x20\x37\x24\xc8"
# "\x00\x00\x01\x00\x01\x00";
# 
alert tcp any any -> $ENIP_SERVER 44818 (msg:"ROCKWELL Automation ControlLogix EtherNET/IP Initialize the device to update the firmware (FlashUp)"; flow:to_server; content:"|6f 00|"; offset:0; depth:2; content:"|00 00 00 00|"; distance:22; within:4; byte_extract:2,2,count,relative,multiplier 4,little; content:"|b2 00|"; distance:0; within:count; content:"|4b|"; distance:2; within:1; content:"|20 a1|"; distance:1; within:2; classtype:attempted-admin; reference:osvdb,78492; reference:secunia,47737; sid:1111691; rev:1;)
